/* ═══════════════════════════════════════════════
   RESET & VARIABLES
════════════════════════════════════════════════ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg:       #f4f6f9;
  --surface:  #ffffff;
  --navy:     #1a2744;
  --accent:   #3b6fff;
  --success:  #16a34a;
  --danger:   #dc2626;
  --text:     #1a2744;
  --muted:    #64748b;
  --border:   #e2e8f0;
  --radius:   12px;
  --shadow:   0 2px 16px rgba(26,39,68,0.08);
}

html, body { height: 100%; }

body {
  font-family: 'Sora', sans-serif;
  background: var(--bg);
  color: var(--text);
  font-size: 14px;
  line-height: 1.5;
}

/* ═══════════════════════════════════════════════
   SCREEN SYSTEM
════════════════════════════════════════════════ */
.screen        { display: none; }
.screen.active { display: block; }

/* ═══════════════════════════════════════════════
   TOP BAR
════════════════════════════════════════════════ */
.topbar {
  background: var(--navy);
  height: 60px;
  padding: 0 32px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  z-index: 200;
}

.topbar-brand {
  display: flex;
  align-items: center;
  gap: 10px;
  color: #fff;
  font-size: 15px;
  font-weight: 600;
}

.topbar-logo {
  width: 28px; height: 28px;
  background: var(--accent);
  border-radius: 7px;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
}

.topbar-user {
  display: none;
  align-items: center;
  gap: 10px;
}

.topbar-user.visible { display: flex; }

.user-avatar {
  width: 32px; height: 32px;
  border-radius: 50%;
  background: var(--accent);
  display: flex; align-items: center; justify-content: center;
  font-size: 13px; font-weight: 700; color: #fff;
  overflow: hidden; flex-shrink: 0;
}

.user-avatar img { width: 100%; height: 100%; object-fit: cover; }
.user-name { font-size: 13px; color: rgba(255,255,255,0.8); }

.btn-signout {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.15);
  color: rgba(255,255,255,0.7);
  font-family: 'Sora', sans-serif;
  font-size: 12px; font-weight: 500;
  padding: 5px 12px; border-radius: 6px;
  cursor: pointer;
  transition: background 0.15s, color 0.15s;
}

.btn-signout:hover { background: rgba(255,255,255,0.18); color: #fff; }

/* ═══════════════════════════════════════════════
   CENTERED SCREENS (setup / login / denied)
════════════════════════════════════════════════ */
.centered-wrap {
  min-height: calc(100vh - 60px);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 32px 20px;
}

.auth-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 20px;
  box-shadow: var(--shadow);
  padding: 48px 40px;
  width: 100%; max-width: 460px;
  text-align: center;
}

.auth-icon {
  width: 64px; height: 64px;
  background: #f8fafc;
  border-radius: 16px;
  display: flex; align-items: center; justify-content: center;
  margin: 0 auto 24px;
}

.auth-title { font-size: 22px; font-weight: 700; color: var(--navy); margin-bottom: 8px; }
.auth-sub   { font-size: 13px; color: var(--muted); line-height: 1.6; margin-bottom: 28px; }
.auth-note  { font-size: 12px; color: var(--muted); margin-top: 16px; line-height: 1.5; }

.link-btn {
  background: none; border: none;
  font-family: 'Sora', sans-serif;
  font-size: 12px; color: var(--muted);
  cursor: pointer; text-decoration: underline;
  margin-top: 8px;
  display: block; width: 100%; text-align: center;
}

.link-btn:hover { color: var(--navy); }

.btn-google {
  display: flex; align-items: center; justify-content: center; gap: 12px;
  width: 100%; padding: 13px 24px;
  background: #fff;
  border: 1.5px solid var(--border);
  border-radius: 10px;
  font-family: 'Sora', sans-serif;
  font-size: 14px; font-weight: 600; color: var(--text);
  cursor: pointer;
  transition: border-color 0.15s, box-shadow 0.15s, transform 0.1s;
  box-shadow: 0 1px 4px rgba(0,0,0,0.06);
  margin-bottom: 4px;
}

.btn-google:hover {
  border-color: var(--accent);
  box-shadow: 0 4px 16px rgba(59,111,255,0.12);
  transform: translateY(-1px);
}

.denied-icon  { font-size: 48px; margin-bottom: 20px; }
.denied-email {
  display: inline-block;
  background: #fef2f2; border: 1px solid #fecaca;
  border-radius: 6px; padding: 5px 14px;
  font-size: 13px; font-weight: 600; color: var(--danger);
  margin-bottom: 16px;
}

/* ═══════════════════════════════════════════════
   FORM FIELDS (setup screen)
════════════════════════════════════════════════ */
.field { text-align: left; margin-bottom: 20px; }

.field label {
  display: block;
  font-size: 11px; font-weight: 700;
  letter-spacing: 0.6px; text-transform: uppercase;
  color: var(--muted); margin-bottom: 7px;
}

.field input {
  width: 100%; padding: 11px 14px;
  border: 1.5px solid var(--border); border-radius: 8px;
  font-family: 'Sora', sans-serif; font-size: 13px; color: var(--text);
  background: var(--bg); outline: none;
  transition: border-color 0.2s, box-shadow 0.2s;
}

.field input:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(59,111,255,0.1);
  background: #fff;
}

.field-hint { font-size: 12px; color: var(--muted); margin-top: 6px; line-height: 1.5; }
.field-hint code { background: #f1f5f9; padding: 1px 5px; border-radius: 4px; font-size: 11px; }

/* ═══════════════════════════════════════════════
   MAIN APP LAYOUT
════════════════════════════════════════════════ */
.main {
  max-width: 860px;
  margin: 0 auto;
  padding: 36px 24px 80px;
}

/* ═══════════════════════════════════════════════
   STEP PANELS
════════════════════════════════════════════════ */
.step-panel        { display: none; }
.step-panel.active { display: block; }

/* ═══════════════════════════════════════════════
   PAGE HEADER (step 1)
════════════════════════════════════════════════ */
.page-header {
  margin-bottom: 20px;
}

.page-title { font-size: 22px; font-weight: 700; color: var(--navy); margin-bottom: 4px; }
.page-sub   { font-size: 13px; color: var(--muted); }

/* ═══════════════════════════════════════════════
   SEARCH BAR
════════════════════════════════════════════════ */
.search-wrap {
  margin-bottom: 16px;
}

.search-box {
  display: flex;
  align-items: center;
  gap: 10px;
  background: var(--surface);
  border: 1.5px solid var(--border);
  border-radius: 10px;
  padding: 0 14px;
  transition: border-color 0.2s, box-shadow 0.2s;
}

.search-box:focus-within {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(59,111,255,0.08);
}

.search-icon { color: var(--muted); flex-shrink: 0; width: 18px; height: 18px; }

.search-box input {
  flex: 1;
  border: none; outline: none; background: transparent;
  font-family: 'Sora', sans-serif;
  font-size: 14px; color: var(--text);
  padding: 13px 0;
}

.search-box input::placeholder { color: var(--muted); }

.search-clear {
  background: none; border: none;
  color: var(--muted); cursor: pointer;
  font-size: 13px; padding: 4px;
  border-radius: 4px;
  transition: color 0.15s, background 0.15s;
  flex-shrink: 0;
}

.search-clear:hover { color: var(--navy); background: var(--bg); }

/* ═══════════════════════════════════════════════
   PROGRAMME LIST
════════════════════════════════════════════════ */
.prog-list { display: grid; gap: 10px; }

.prog-card {
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 16px 20px;
  background: var(--surface);
  border: 1.5px solid var(--border);
  border-radius: 10px;
  transition: border-color 0.15s, box-shadow 0.15s;
}

.prog-card:hover { border-color: #c7d7ff; box-shadow: 0 2px 12px rgba(59,111,255,0.08); }

.prog-icon {
  width: 40px; height: 40px;
  background: #eff4ff; border-radius: 9px;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0; color: var(--accent);
}

.prog-info { flex: 1; min-width: 0; }
.prog-name { font-size: 14px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.prog-meta { font-size: 12px; color: var(--muted); margin-top: 2px; }

/* Action buttons on each programme card */
.prog-actions {
  display: flex;
  gap: 8px;
  flex-shrink: 0;
}

.prog-btn {
  display: inline-flex; align-items: center; gap: 5px;
  padding: 7px 14px;
  border-radius: 7px;
  font-family: 'Sora', sans-serif;
  font-size: 12px; font-weight: 600;
  cursor: pointer;
  border: 1.5px solid var(--border);
  background: var(--surface);
  color: var(--muted);
  transition: all 0.15s;
  white-space: nowrap;
}

.prog-btn:hover { border-color: var(--navy); color: var(--navy); }

.prog-btn.view {
  border-color: var(--accent);
  color: var(--accent);
  background: #f0f4ff;
}

.prog-btn.view:hover { background: #e0eaff; }

.prog-btn.edit {
  background: var(--navy);
  border-color: var(--navy);
  color: #fff;
}

.prog-btn.edit:hover { background: #253460; }

.prog-empty {
  text-align: center;
  padding: 40px 20px;
  color: var(--muted);
  font-size: 14px;
}

/* Skeleton */
.skeleton {
  height: 80px; border-radius: 10px;
  background: linear-gradient(90deg, #f1f5f9 25%, #e2e8f0 50%, #f1f5f9 75%);
  background-size: 200% 100%;
  animation: shimmer 1.2s infinite;
}

@keyframes shimmer {
  from { background-position: 200% 0; }
  to   { background-position: -200% 0; }
}

/* ═══════════════════════════════════════════════
   STEP TOP BAR (view / edit / output screens)
════════════════════════════════════════════════ */
.step-topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
  gap: 12px;
}

.back-btn {
  display: inline-flex; align-items: center; gap: 6px;
  background: none; border: none;
  font-family: 'Sora', sans-serif;
  font-size: 13px; font-weight: 600;
  color: var(--muted); cursor: pointer;
  padding: 6px 0;
  transition: color 0.15s;
}

.back-btn:hover { color: var(--navy); }

.step-topbar-actions { display: flex; gap: 8px; }

/* ═══════════════════════════════════════════════
   CARDS
════════════════════════════════════════════════ */
.card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 28px 32px;
  margin-bottom: 16px;
}

.card-title    { font-size: 18px; font-weight: 700; color: var(--navy); margin-bottom: 4px; }
.card-subtitle { font-size: 13px; color: var(--muted); line-height: 1.6; margin-bottom: 20px; }

/* ═══════════════════════════════════════════════
   VIEW MODE TABLE
════════════════════════════════════════════════ */
.view-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 16px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.view-meta { font-size: 12px; color: var(--muted); margin-top: 4px; }

/* The view table — styled but clean for reading */
.view-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
}

.view-table th, .view-table td {
  padding: 12px 16px;
  text-align: left;
  vertical-align: top;
  border-bottom: 1px solid var(--border);
}

.view-table thead th {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  color: var(--muted);
  background: var(--bg);
  border-bottom: 1.5px solid var(--border);
}

.view-table thead th:first-child { width: 28%; }

.view-table tbody tr:last-child td { border-bottom: none; }

.view-table tbody td:first-child {
  font-weight: 600;
  color: var(--navy);
}

.view-table tbody td:last-child { color: var(--text); line-height: 1.6; }

/* Inline edit button on each view row */
.view-table .inline-edit-btn {
  display: inline-flex; align-items: center; gap: 4px;
  opacity: 0;
  transition: opacity 0.15s;
  background: none; border: 1px solid var(--border);
  border-radius: 5px; padding: 3px 8px;
  font-family: 'Sora', sans-serif; font-size: 11px; font-weight: 600;
  color: var(--muted); cursor: pointer;
  margin-left: 8px;
  vertical-align: middle;
  transition: opacity 0.15s, border-color 0.15s, color 0.15s;
}

.view-table tr:hover .inline-edit-btn { opacity: 1; }
.view-table .inline-edit-btn:hover { border-color: var(--accent); color: var(--accent); }

/* Empty state in view */
.view-empty {
  text-align: center;
  padding: 32px 20px;
  color: var(--muted);
  font-size: 13px;
  line-height: 1.6;
}

.copy-bar { margin-top: 16px; min-height: 20px; }

/* ═══════════════════════════════════════════════
   EDIT MODE — QUAL GRID
════════════════════════════════════════════════ */
.section-hdr {
  display: flex; align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
}

.section-title { font-size: 15px; font-weight: 700; color: var(--navy); }
.section-meta  { font-size: 12px; color: var(--muted); }

.qual-grid { display: grid; gap: 12px; }

.qual-item {
  border: 1.5px solid var(--border);
  border-radius: 10px; overflow: hidden;
  transition: border-color 0.2s;
}

.qual-item:focus-within { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(59,111,255,0.07); }
.qual-item.has-value    { border-color: #86efac; }

.qual-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px 14px;
  background: rgba(26,39,68,0.025);
  border-bottom: 1.5px solid var(--border);
  cursor: pointer; user-select: none;
}

.qual-item.has-value .qual-header { background: rgba(22,163,74,0.05); border-bottom-color: #bbf7d0; }

.qual-name {
  font-size: 13px; font-weight: 600; color: var(--navy);
  display: flex; align-items: center; gap: 8px;
}

.qual-badge {
  font-size: 10px; font-weight: 700;
  letter-spacing: 0.4px; text-transform: uppercase;
  padding: 2px 7px; border-radius: 4px;
}

.qual-badge.filled { background: #dcfce7; color: var(--success); }
.qual-badge.empty  { background: #f1f5f9; color: var(--muted); }

.qual-body { background: #fff; }

.qual-body textarea {
  width: 100%; padding: 12px 14px;
  border: none; outline: none; resize: vertical;
  font-family: 'Sora', sans-serif; font-size: 13.5px; color: var(--text);
  background: transparent; min-height: 64px; line-height: 1.6; display: block;
}

.qual-body textarea::placeholder { color: #94a3b8; font-style: italic; }

/* ═══════════════════════════════════════════════
   BUTTONS
════════════════════════════════════════════════ */
.btn-row {
  display: flex; gap: 10px;
  align-items: center; justify-content: flex-end;
}

.btn {
  display: inline-flex; align-items: center; gap: 7px;
  padding: 11px 22px; border-radius: 8px;
  font-family: 'Sora', sans-serif;
  font-size: 14px; font-weight: 600;
  cursor: pointer; border: none;
  transition: background 0.15s, transform 0.1s, box-shadow 0.15s;
  white-space: nowrap;
}

.btn:active { transform: scale(0.98); }

.btn-primary {
  background: var(--accent); color: #fff;
  box-shadow: 0 2px 10px rgba(59,111,255,0.25);
}

.btn-primary:hover    { background: #2d5fe8; }
.btn-primary:disabled { background: #94a3b8; box-shadow: none; cursor: not-allowed; transform: none; }

.btn-success { background: var(--success); color: #fff; }
.btn-success:hover { background: #15803d; }

.btn-ghost {
  background: transparent; color: var(--muted);
  border: 1.5px solid var(--border);
}

.btn-ghost:hover { border-color: var(--navy); color: var(--navy); }

.btn-sm  { padding: 8px 14px; font-size: 12px; }
.btn-full { width: 100%; justify-content: center; }

/* ═══════════════════════════════════════════════
   TOAST
════════════════════════════════════════════════ */
.toast {
  display: none;
  align-items: flex-start; gap: 10px;
  padding: 13px 16px; border-radius: 8px;
  font-size: 13px; line-height: 1.5;
  margin-bottom: 16px;
  animation: slideDown 0.25s ease;
}

.toast.visible { display: flex; }
.toast.info    { background: #eff6ff; color: #1d4ed8; border: 1px solid #bfdbfe; }
.toast.success { background: #f0fdf4; color: #15803d; border: 1px solid #bbf7d0; }
.toast.error   { background: #fef2f2; color: #b91c1c; border: 1px solid #fecaca; }
.toast.warn    { background: #fffbeb; color: #92400e; border: 1px solid #fde68a; }

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-6px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* ═══════════════════════════════════════════════
   SPINNER
════════════════════════════════════════════════ */
.spinner {
  width: 14px; height: 14px; flex-shrink: 0;
  border: 2px solid rgba(255,255,255,0.3);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 0.65s linear infinite;
}

@keyframes spin { to { transform: rotate(360deg); } }

/* ═══════════════════════════════════════════════
   OUTPUT (step 4)
════════════════════════════════════════════════ */
.output-saved-badge {
  display: inline-flex; align-items: center; gap: 6px;
  font-size: 11px; font-weight: 700;
  letter-spacing: 0.4px; text-transform: uppercase;
  color: var(--success); background: #dcfce7;
  border: 1px solid #bbf7d0;
  padding: 4px 10px; border-radius: 20px;
  margin-bottom: 12px;
}

.output-footer {
  display: flex; align-items: center; gap: 14px;
  margin-top: 20px; flex-wrap: wrap;
}

.copy-confirm {
  display: none; font-size: 13px;
  color: var(--success); font-weight: 600;
}

.copy-confirm.visible { display: inline; }

/* Output table — no styles, pastes clean */
#preview-table {
  width: 100%; border-collapse: collapse;
  font-size: 14px; font-family: sans-serif;
}

#preview-table th, #preview-table td {
  border: 1px solid #d1d5db;
  padding: 10px 14px;
  text-align: left; vertical-align: top; line-height: 1.5;
}

#preview-table thead th { background: #f8fafc; font-weight: 700; font-size: 13px; }
#preview-table tbody td:first-child { font-weight: 700; width: 30%; }

/* ═══════════════════════════════════════════════
   INLINE EDIT MODAL
════════════════════════════════════════════════ */
.modal-overlay {
  display: none;
  position: fixed; inset: 0;
  background: rgba(15,23,42,0.4);
  backdrop-filter: blur(2px);
  z-index: 300;
  animation: fadeIn 0.2s ease;
}

.modal-overlay.open { display: block; }

.inline-modal {
  display: none;
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%) scale(0.96);
  width: 100%; max-width: 500px;
  background: var(--surface);
  border-radius: 16px;
  box-shadow: 0 20px 60px rgba(15,23,42,0.25);
  z-index: 301;
  overflow: hidden;
  animation: popIn 0.2s ease forwards;
}

.inline-modal.open {
  display: block;
}

@keyframes popIn {
  from { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
  to   { opacity: 1; transform: translate(-50%, -50%) scale(1); }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to   { opacity: 1; }
}

.modal-header {
  display: flex; align-items: flex-start;
  justify-content: space-between; gap: 12px;
  padding: 20px 24px 16px;
  border-bottom: 1px solid var(--border);
}

.modal-prog-label {
  font-size: 11px; font-weight: 600;
  letter-spacing: 0.5px; text-transform: uppercase;
  color: var(--muted); margin-bottom: 4px;
}

.modal-title {
  font-size: 16px; font-weight: 700; color: var(--navy);
}

.modal-close {
  background: none; border: none;
  color: var(--muted); cursor: pointer;
  padding: 4px; border-radius: 6px;
  transition: background 0.15s, color 0.15s;
  flex-shrink: 0; margin-top: 2px;
}

.modal-close:hover { background: var(--bg); color: var(--navy); }

.modal-body { padding: 20px 24px; }

.modal-label {
  display: block;
  font-size: 11px; font-weight: 700;
  letter-spacing: 0.5px; text-transform: uppercase;
  color: var(--muted); margin-bottom: 8px;
}

.modal-body textarea {
  width: 100%; padding: 12px 14px;
  border: 1.5px solid var(--border); border-radius: 8px;
  font-family: 'Sora', sans-serif; font-size: 14px; color: var(--text);
  background: var(--bg); outline: none; resize: vertical; min-height: 100px; line-height: 1.6;
  transition: border-color 0.2s, box-shadow 0.2s;
}

.modal-body textarea:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(59,111,255,0.1);
  background: #fff;
}

.modal-hint { font-size: 12px; color: var(--muted); margin-top: 8px; line-height: 1.5; }

.modal-footer {
  display: flex; align-items: center;
  justify-content: flex-end; gap: 8px;
  padding: 14px 24px 20px;
  border-top: 1px solid var(--border);
}

/* ═══════════════════════════════════════════════
   UTILITIES
════════════════════════════════════════════════ */
.hidden { display: none !important; }

/* ═══════════════════════════════════════════════
   RESPONSIVE
════════════════════════════════════════════════ */
@media (max-width: 640px) {
  .topbar { padding: 0 16px; }
  .main { padding: 20px 16px 60px; }
  .card { padding: 20px; }
  .auth-card { padding: 32px 20px; }
  .prog-actions { flex-direction: column; gap: 6px; }
  .prog-btn { font-size: 11px; padding: 6px 10px; }
  .step-topbar-actions { gap: 6px; }
  .inline-modal { max-width: calc(100vw - 32px); }
}